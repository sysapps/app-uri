<!DOCTYPE html>
<html>
  <head>
    <meta name="generator" content=
    "HTML Tidy for HTML5 (experimental) for Mac OS X https://github.com/w3c/tidy-html5/tree/c63cc39">
    <meta charset="UTF-8">
    <title>
      The app: URI scheme
    </title>
    <style>
figcaption:before {
            content:"Figure: ";
            font-weight: bold;
        }
        figure table {
            margin: auto;
            border: 1px solid #aaa;
        }
        figure td {
            text-align: center;
            padding: .25em .5em .25em .25em;
            vertical-align: middle;
        }
    </style>
    <style class="w3c">
.stability {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            margin: 0 auto 0 auto;
            width: 50%;
            background: maroon;
            color: yellow;
            -webkit-border-radius: 1em 1em 0 0;
            -moz-border-radius: 1em 1em 0 0;
            border-radius: 1em 1em 0 0;
            -moz-box-shadow: 0 0 1em #500;
            -webkit-box-shadow: 0 0 1em #500;
            box-shadow: 0 0 1em red;
            padding: 0.5em 1em;
            text-align: center;
        }
        .stability strong {
            display: block;
        }
        .stability button {
            -moz-appearance: none;
            -webkit-appearance: none;
            margin: 0;
            border: 0;
            padding: 0.25em 0.5em;
            background: transparent;
            color: black;
            position: absolute;
            top: -0.5em;
            right: 0;
            font: 1.25em sans-serif;
            text-align: center;
        }
        .stability button:hover {
            color: white;
            text-shadow: 0 0 2px black;
        }
        .stability button:active {
            padding: 0.3em 0.45em 0.2em 0.55em;
        }
        .stability :link, .stability :visited, .stability :link:hover, 
        .stability :visited:hover {
            background: transparent;
            color: white;
        }
    </style>
    <link class="w3c" href="http://www.w3.org/StyleSheets/TR/W3C-WD.css" rel=
    "stylesheet">
    <link class="nopub" href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel=
    "stylesheet">
    <style>
        table {
                        margin: auto;
                        text-align: center;
                        
                }
                td{
                        vertical-align:bottom;
                }
    </style>
    <style class="nopub">
span{
                border: 1px dotted green;
        }
    </style>
  </head>
  <body>
    <div class="head">
      <a href="http://www.w3.org/"><img width="72" height="48" src=
      "http://www.w3.org/Icons/w3c_home" alt="W3C"></a>
      <h1 class="no-num no-toc">
        [TITLE]
      </h1>
      <h2 class="no-num no-toc">
        <span class="w3c">W3C First Public Working Draft [DATE]</span>
        <span class="nopub">[LONGSTATUS]- Last updated [DATE]</span>
      </h2>
      <dl class="nopub">
        <dt>
          This Version:
        </dt>
        <dd>
          <a href=
          "http://www.w3.org/2012/sysapps/app-uri/">http://www.w3.org/2012/sysapps/app-uri/</a>
        </dd>
        <dt>
          Git Repo:
        </dt>
        <dd>
          <a href=
          "https://github.com/sysapps/app-uri">https://github.com/sysapps/app-uri</a>
        </dd>
        <dt>
          Version history:
        </dt>
        <dd>
          <a href="https://github.com/sysapps/app-uri/commits/gh-pages">Github
          commits</a>
        </dd>
        <dt>
          Bug tracker:
        </dt>
        <dd>
          <a href="https://github.com/sysapps/app-uri/issues">Issue tracker on
          github</a>
        </dd>
      </dl>
      <dl class="w3c">
        <dt>
          This Version:
        </dt>
        <dd>
          <a href="[VERSION]">[VERSION]</a>
        </dd>
        <dt>
          Latest published version:
        </dt>
        <dd>
          <a href="[LATEST]">[LATEST]</a>
        </dd>
        <dt>
          Latest editor's draft:
        </dt>
        <dd>
          <a href=
          "http://www.w3.org/2012/sysapps/app-uri/">http://www.w3.org/2012/sysapps/app-uri/</a>
        </dd>
        <dt>
          Previous version:
        </dt>
        <dd>
          None
        </dd>
        <dt>
          Editor:
        </dt>
        <dd>
          <a href="http://marcosc.com/">Marcos Cáceres</a>, Mozilla
          Corporation.
        </dd>
        <dt>
          Bug tracker:
        </dt>
        <dd>
          <a href="https://github.com/sysapps/app-uri/issues">Issue tracker on
          github</a>
        </dd>
      </dl>
      <div>
        <p class="copyright">
          <a href=
          "http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
          © [YEAR] <a href="http://www.w3.org/"><abbr title=
          "World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href=
          "http://www.csail.mit.edu/"><abbr title=
          "Massachusetts Institute of Technology">MIT</abbr></a>, <a href=
          "http://www.ercim.eu/"><abbr title=
          "European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
          <a href="http://www.keio.ac.jp/">Keio</a>, <a href=
          "http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved. W3C
          <a href=
          "http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
          <a href=
          "http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
          and <a href=
          "http://www.w3.org/Consortium/Legal/copyright-documents">document
          use</a> rules apply.
        </p>
        <hr>
      </div>
    </div>
    <h2 class="no-num no-toc">
      Abstract
    </h2>
    <p>
      This specification defines the <code>app:</code> URI scheme and rules for
      dereferencing an <code>app:</code> URI, which can be used to address
      resources inside a package (e.g., a packaged application). The
      dereferencing model relies on HTTP semantics to return resources in a
      manner akin to a HTTP <code>GET</code> request. Doing so allows this URI
      scheme to be used with other technologies that rely on HTTP responses to
      function as intended, such as <span>[XHR]</span>.
    </p>
    <h2 class="no-num no-toc">
      Status of This Document
    </h2>
    <p>
      <em>This section describes the status of this document at the time of its
      publication. Other documents may supersede this document. A list of
      current W3C publications and the latest revision of this technical report
      can be found in the <a href="http://www.w3.org/TR/">W3C technical reports
      index</a> at http://www.w3.org/TR/.</em>
    </p>
    <p class="w3c">
      Publication as a First Public Working Draft does not imply endorsement by
      the W3C Membership. This is a draft document and may be updated, replaced
      or obsoleted by other documents at any time. It is inappropriate to cite
      this document as other than work in progress.
    </p>
    <p>
      Implementors should be aware that this specification is not stable.
      <strong>Implementors who are not taking part in the discussions are
      likely to find the specification changing out from under them in
      incompatible ways.</strong> Vendors interested in implementing this
      specification before it eventually reaches the Candidate Recommendation
      stage should join the aforementioned mailing lists and take part in the
      discussions.
    </p>
    <!-- q.v. http://lists.w3.org/Archives/Public/public-html/2010Oct/0457.html -->
    <p class="stability w3c" id="wip">
      <strong>This is a work in progress!</strong> For the latest updates from
      the HTML WG, possibly including important bug fixes, please look at the
      <a href="http://www.w3.org/2012/sysapps/app-uri/">editor's draft</a>
      instead. <button onclick="closeWarning(this.parentNode)">X</button>
    </p><script>
function closeWarning(element) {
    element.parentNode.removeChild(element);
    var date = new Date();
    date.setDate(date.getDate()+4);
    document.cookie = 'hide-obsolescence-warning=1; expires=' + date.toGMTString();
    }
    if (getCookie('hide-obsolescence-warning') == '1')
    setTimeout(function () { document.getElementById('wip').parentNode.removeChild(document.getElementById('wip')); }, 2000);
    </script>
    <p>
      This is the First Public Working Draft of <cite>The app: URI
      scheme</cite> specification. This document was produced by the <a href=
      "http://www.w3.org/2012/sysapps/">System Applications Working Group</a>.
      If you wish to make comments regarding this document, please send them to
      <a href="mailto:public-sysapps@w3.org">public-sysapps@w3.org</a>
      (<a href="mailto:public-sysapps-request@w3.org?subject=subscribe">subscribe</a>,
      <a href=
      "http://lists.w3.org/Archives/Public/public-sysapps/">archives</a>). All
      feedback is welcome.
    </p>
    <p>
      This document was produced by a group operating under the <a href=
      "http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004
      W3C Patent Policy</a>. W3C maintains a <a href=
      "http://www.w3.org/2004/01/pp-impl/58119/status" rel="disclosure">public
      list of any patent disclosures</a> made in connection with the
      deliverables of the group; that page also includes instructions for
      disclosing a patent. An individual who has actual knowledge of a patent
      which the individual believes contains <a href=
      "http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
      Claim(s)</a> must disclose the information in accordance with <a href=
      "http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
      6 of the W3C Patent Policy</a>.
    </p>
    <h2 class="no-toc no-num">
      Table of Contents
    </h2><!-- toc -->
    <h2>
      Introduction
    </h2>
    <p>
      <em>This section is non-normative.</em>
    </p>
    <p>
      HTML applications that run locally on a file system have traditionally
      relied on the <dfn>file URL scheme</dfn> of <span>[RFC1738]</span> as a
      <a href=
      "http://www.whatwg.org/specs/web-apps/current-work/#the-document's-address">
      document's address</a>. Although usable in a great deal of cases, relying
      on the <span>file URL scheme</span> has several serious drawbacks:
    </p>
    <ul>
      <li>
        <p>
          <strong>Lack of HTTP response semantics:</strong> meaning that it is
          not possible to use, for instance, <span>[XHR]</span> to retrieve
          resources from within a package.
        </p>
      </li>
      <li>
        <p>
          <strong>Security/privacy issues:</strong> on Unix systems, naive
          implementations expose the username as part of the path, as well as
          the full path on the file system to where a file is residing (e.g.,
          "/Users/<strong>username</strong>/app/index.html"). In addition, the
          <span>file URL scheme</span> potentially opens up the ability for an
          attacker to address any file on the file system.
        </p>
      </li>
      <li>
        <strong>Undefined security model:</strong> The HTML specification lacks
        a security model definition for when the <span>file URL scheme</span>
        is used as a <a href=
        "http://www.whatwg.org/specs/web-apps/current-work/#the-document's-address">
        document's address</a>, meaning that different user agents behave
        inconsistently when content is loaded using the <span>file URL
        scheme</span> (e.g., same origin policy doesn't apply, local storage
        areas of <span>[WebStorage]</span> don't work as expected if at all,
        and so on).
      </li>
    </ul>
    <p>
      As stated by <span>[RFC1738]</span>:
    </p>
    <blockquote>
      <q>The <span>file URL scheme</span> is unusual in that it does not
      specify an Internet protocol or access method for such files; as such,
      its utility in network protocols between hosts is limited.</q>
    </blockquote>
    <p>
      To overcome the above limitations of the <span><code>file</code>: URL
      scheme</span>, this specification standardizes the
      <span><code>app:</code> URI</span> scheme and <span>rules for
      dereferencing an <code>app:</code> URI</span>. As a replacement
      technology for the <span>file URL scheme</span>, the <code>app:</code>
      URIs serve a number of functions:
    </p>
    <ol>
      <li>
        <p>
          An <code>app:</code> URI is a safer alternative to the <span>file URL
          scheme</span>, as it does not allow addressing outside a sand-boxed
          environment. Additionally, it does not expose the location of a file
          on user's local device, nor their username, as in the case with some
          Unix-based implementations.
        </p>
      </li>
      <li>
        <p>
          An <code>app:</code> URI can serve as a <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#the-document's-address">
          document's address</a>, which can serve as the <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#origin">origin</a>
          for <span>[HTML]</span> or <span>[SVG]</span> applications. This
          enables the use of many features that rely on the <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#same-origin">same-origin
          policy</a> (e.g., <span>[WebStorage]</span>) and allows a user agent
          to <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#resolve-a-url">resolve</a>
          the attribute values of certain DOM elements (e.g., the
          <code>img</code> element's <code>src</code> attribute).
        </p>
      </li>
      <li>An <code>app:</code> URI provides a means to retrieve a file from
      within a package using similar semantics to performing a <code>GET</code>
      request over <span>[HTTP]</span>. This allows the <code>app:</code> URI
      scheme to be used with other technologies that rely on HTTP responses,
      such as <span>[XHR]</span>. It also allows the DOM elements to respond
      accordingly based on how resources are loaded or if a HTTP-like error
      occurs (e.g., firing an event when a resource is not found, or access is
      denied for security reasons).
      </li>
    </ol>
    <h2 id="example-of-usage">
      Example of usage
    </h2>
    <p>
      <em>This section is non-normative.</em>
    </p>
    <figure>
      <table>
        <tr>
          <td>
            <p>
              <img src="images/gift.png" width="32" height="32" alt=
              "package"><br>
              ToyApp.zip
            </p>
          </td>
          <td>
            <img src="images/toy1.png" width="32" height="32" alt="app1"><br>
            running instance
          </td>
          <td>
            <code>app://c13c...6f30/index.html</code>
          </td>
        </tr>
      </table>
      <figcaption>
        Given an packaged application (ToyApp.zip), a user agent creates a
        running instance with a unique <code>app:</code> URI.
      </figcaption>
    </figure>
    <p>
      Using then <code>app:</code> URI above, the following example shows
      [HTML]'s <code>window.location</code> using then <span><code>app:</code>
      URI</span>.
    </p>
    <pre>
&lt;!doctype html&gt;
&lt;script&gt;
//Example using HTML's Location object
var loc =  window.location; 
console.log(loc.protocol === "app:"); //true 
console.log(loc.host === "c13c6f30-ce25-11e0-9572-0800200c9a66"); //true 
console.log(loc.href === "app://c13c6f30-ce25-11e0-9572-0800200c9a66/index.html"); //true 
console.log(loc.origin === "app://c13c6f30-ce25-11e0-9572-0800200c9a66"); //true 
console.log(loc.pathname === "/index.html"); //true 
console.log(loc.hash === "#example"); //true 
console.log(loc.port === ""); //true
&lt;/script&gt;
</pre>
    <p>
      This example shows an <span><code>app:</code> URI</span> being <a href=
      "http://www.whatwg.org/specs/web-apps/current-work/#resolve-a-url">resolved</a>
      in <span>[HTML]</span>.
    </p>
    <pre>
var img = document.createElement("img");

//the following setter triggers HTML's resolve algorithm 
img.src = "example.gif"; 

//and the expected output: 
console.log(img.src === "app://c13c6f30-ce25-11e0-9572-0800200c9a66/example.gif") //true

//Append the image to the document
document.body.appendChild(img); 
&lt;/script&gt;
</pre>
    <p>
      This example shows a resource within a packaged application being
      retrieved over <span>[XHR]</span>.
    </p>
    <pre>
function process() {
  // process the resulting data 
}

var xhr = new XMLHttpRequest();
xhr.onload = (hxr) =&gt; process (xhr.responseText);
xhr.open( "GET", "playlist.json");
xhr.send();
</pre><!-- OddPage -->
    <h2>
      Conformance
    </h2>
    <p>
      Everything in this specification is normative except for sections
      explicitly marked as non-normative, examples, and notes.
    </p>
    <p>
      The key words <em class="rfc2119" title="must">must</em>, <em class=
      "rfc2119" title="should">should</em>, <em class="rfc2119" title=
      "recommended">recommended</em>, and <em class="rfc2119" title=
      "optional">optional</em> in this specification are to be interpreted as
      described in <span>[RFC2119</span>].
    </p>
    <p>
      There is one class of product that can claim conformance to this
      specification: a <span>user agent</span>.
    </p><!-- OddPage -->
    <h2>
      User agent
    </h2>
    <p>
      A <dfn>user agent</dfn> is an implementation of this specification that
      is able to <span title="synthesizing">synthesize <code>app:</code>
      URIs</span> as well as <span title=
      "rules for dereferencing an app: URI">dereference</span> them.
    </p><!-- OddPage -->
    <h2>
      Package
    </h2>
    <p>
      A <dfn>package</dfn> is the logical container that contains the files
      being addressed via the <code>app:</code> uri scheme.
    </p>
    <h2>
      App URI
    </h2>
    <p>
      An <dfn><code>app:</code> URI</dfn> is a string that conforms to the
      production of the following <span>[ABNF]</span>:
    </p>
    <pre>
<dfn>appuri</dfn> = scheme "://" <span>authority</span> <span>path</span> [ "?" <span>query</span> ] [ "#" <span>fragment</span> ]
<dfn>scheme</dfn> = "app"
<span>authority</span> = 1*<span>unreserved</span> / <span>uuid</span> 
  
</pre>Where <code><a href=
"http://tools.ietf.org/html/rfc3986"><dfn>path</dfn></a></code>, <code><dfn>
    <a href=
    "http://tools.ietf.org/html/rfc3986#section-3.4">query</a></dfn></code>,
    <code><dfn><a href=
    "http://tools.ietf.org/html/rfc3986#section-3.5">fragment</a></dfn></code>,
    and <code><dfn><a href=
    "http://tools.ietf.org/html/rfc3986#section-2.3">unreserved</a></dfn></code>
    are defined in <span>[IRI]</span>. And, and <code><dfn><a href=
    "http://tools.ietf.org/html/rfc4122#section-3">uuid</a></dfn></code> is
    defined in <span title="uuid-spec">[UUID]</span>. See <span title=
    "synthesizing">Synthesizing an <code>app:</code> URI</span> for more
    information on the use of UUID in construction of the authority field.
    <h3 id="synthesizing">
      Synthesizing an <code>app:</code> URI
    </h3>
    <p>
      When <dfn>synthesizing</dfn> an <span><code>app:</code> URI</span>, a
      user agent <em class="ct"><em class="rfc2119" title="must">MUST</em></em>
      generate a string that conforms to <code>appuri</code>, and normalize it
      using <a href=
      "http://tools.ietf.org/html/rfc3987#section-5.3.2">syntax-based
      normalization</a> as defined in <span>[IRI]</span>.
    </p>
    <h3>
      The authority component
    </h3>
    <p>
      The <dfn id="dfn-authority">authority</dfn> is a unique identifier that
      represents the instance of a software application that is making use of
      then <code>app:</code> URI (e.g., in the case of a packaged application,
      it represents an instance of an application).
    </p>
    <p>
      How long the identifier represented by the authority is bound to an
      instance of an application is application specific (e.g., it may be reset
      when the user clears the user agent's private data, or can last until the
      application is uninstalled from an end-user's device). See <span title=
      "privacy">privacy and security considerations</span>.
    </p>
    <p>
      The reason for having a unique authority is, amongst other things, to
      prevent multiple instances from overriding each other's data.
    </p>
    <p>
      It is <em class="rfc2119" title="recommended">recommended</em> that a
      <span title="uuid-spec">[UUID]</span> be used as the value of the
      <span>authority</span> component (but it's not mandatory! Other types of
      authorities, like <a href=
      "http://en.wikipedia.org/wiki/Reverse_domain_name_notation">reverse
      domain name notation</a>, are allowed). Using a <span>[UUID]</span> makes
      it improbable that two URIs will be alike, and also makes them hard to
      guess.
    </p>
    <h3>
      Query and Fragment components
    </h3>
    <p>
      The <a href="http://url.spec.whatwg.org/#concept-url-query">query</a> and
      <a href="http://url.spec.whatwg.org/#concept-url-fragment">fragment</a>
      components, when present, complement the <a href=
      "http://url.spec.whatwg.org/#concept-url-path">path</a> component in
      identifying a resource within a package <span>[URL]</span>. However, when
      <span title="rules for dereferencing an app: URI">dereferencing</span>,
      the <code>query</code> and <code>fragment</code> components don't play
      any part in locating a file inside of package.
    </p>
    <p>
      For example, the following <code>app:</code> URIs all return the same
      file (example.gif):
    </p>
    <ul>
      <li>
        <code>app://c1..66/example.gif?hello</code>
      </li>
      <li>
        <code>app://c1..66/example.gif?hello=foo&amp;bar=baz</code>
      </li>
      <li>
        <code>app://c1..66/example.gif?hello#hi-there</code>
      </li>
    </ul>
    <h3>
      Dereferencing and retrieval of files from a container
    </h3>
    <p>
      This section describes how a user agent retrieves files from inside a
      container by dereferencing an <code>app:</code> URI, and how a <span>user
      agent</span> handles error conditions (e.g., when a file is not found).
      The purpose of this dereferencing model is to make retrieval of files
      from a container "look and feel" like a HTTP request (except the request
      and response are performed over "<code>app://</code>" instead of
      "<code title="">http://</code>").
    </p>
    <p>
      For simplicity, this specification does not define any means for cache
      control for content inside a container (e.g., dealing with e-tags).
      However, a user agent <em class="ct">MAY</em> implement [HTTP] <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13">cache
      controls</a> if they so desire.
    </p>
    <p>
      A <dfn>response</dfn> means a <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6">HTTP
      response</a> and can include any HTTP <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6">response
      fields</a> (e.g., the name of the user agent as the <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.38">Server:</a>)
      and any <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec7.html#sec7.1">entity
      header fields</a> the user agent deems will be helpful to a developer
      (e.g., <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.13">Content-Length</a>,
      <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.29">Last-Modified</a>,
      <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.18">Date</a>,
      <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11">Content-Encoding</a>,
      <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.15">Content-MD5</a>).
      In the case of an error in the request (i.e., <a href=
      "http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10">status
      codes</a> 500, 501, 400, 404), the user agent <em class="ct">MAY</em>
      include a message describing the error in the <span>[HTTP]</span>
      response body.
    </p>
    <p>
      To dereference a <code>app:</code> <span>URI</span> to a file in a app
      package a <a>user agent</a> <em class="rfc2119" title="must">MUST</em>
      apply the <span>rules for dereferencing an <code>app:</code> URI</span>.
    </p>
    <p>
      The <dfn>rules for dereferencing an <code>app:</code> URI</dfn> are as
      follows:
    </p>
    <ol>
      <li>
        <p>
          If the request is not a <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3">GET
          request</a>, return a <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.2">501
          Not Implemented</a> <span>response</span> and terminate this
          algorithm.
        </p>
      </li>
      <li>
        <p>
          Ignore any <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.3">request
          headers</a>.
        </p>
      </li>
      <li>
        <p>
          Let <var>URI</var> be the value of the <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.2">Request
          URI</a>.
        </p>
      </li>
      <li>
        <p>
          <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#resolve-a-url">Resolve</a>
          <em>URI</em> into an <a href=
          "http://url.spec.whatwg.org/#concept-absolute-url">absolute URL</a>
          using the document's origin as the base.
        </p>
      </li>
      <li>
        <p>
          If the <em>URI</em> does not conform to the <code>appuri</code> ABNF,
          return a <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400
          Bad Request</a> <span>response</span> and terminate this algorithm.
        </p>
      </li>
      <li>
        <p>
          If the <em>URI</em> uses the scheme '<code>app</code>', but the
          <span>authority</span> does not match the one assigned to this
          document, return a <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.4">403
          Forbidden</a> <span>response</span> and terminate this algorithm
          (i.e., prevent inter-application content access).
        </p>
      </li>
      <li>
        <p>
          Let <var>path</var> be the <code>path</code> component of URI.
        </p>
      </li>
      <li>
        <p>
          Let <var>potential-file</var> be the result of attempting locate the
          file at <var>path</var>.
        </p>
      </li>
      <li>
        <p>
          If <var>potential-file</var> is not found at the given path inside
          the container, return a <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5">404
          Not Found</a> <span>response</span>.
        </p>
      </li>
      <li>
        <p>
          Otherwise, if retrieving <var>potential-file</var> results in an
          error (e.g., the file is corrupt, locked, etc.), return a
          <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.1">500
          Internal Server Error</a> <span>response</span>.
        </p>
      </li>
      <li>
        <p>
          Let <var>content-type</var> be the result of applying
          <span>[SNIFF]</span> to determine the <var>content-type</var>.
        </p>
      </li>
      <li>
        <p>
          Return a <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200
          OK</a> <span>response</span>, with the value of
          <var>content-type</var> as the <span>[HTTP]</span> <a href=
          "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17">Content-Type</a>
          header, and with the contents of <var>potential-file</var> as the
          response body.
        </p>
      </li>
    </ol>
    <h2 class="no-num" id="privacy">
      Privacy and Security Considerations
    </h2>
    <p>
      <em>This section is non-normative.</em>
    </p>
    <p>
      Because <span>[UUID]</span>s used by the app: URI scheme are effectively
      a digital finger print, an application developer could use a UUID to
      personally identify a user. This can allow a developer to, for example,
      restore cookies even if the user has cleared cookies from a user agent.
      As such, user agents should provide end-users with a means of
      regenerating the authority component of an app: URI. For example, the
      UUID for an application could be regenerated every time the application
      is started. Or the UUID could be regenerated when the user clears private
      data from the user agent.
    </p>
    <p>
      When dereferencing an <code>app:</code> URI, a user agent needs to make
      sure that only files that were in the package can be accessed (i.e.,
      those files should be sand-boxed). User agents need to watch out for
      <a href="http://en.wikipedia.org/wiki/Symbolic_link">symbolic links</a>
      (or similar) inside a package, which can attempt to trick the user agent
      into accessing files that are on other parts of the file system.
    </p>
    <p>
      As this specification relies on the standardized heuristics for
      determining the content type of files defined in the <span>[SNIFF]</span>
      specification, implementors need to consider the security considerations
      discussed in the <span>[SNIFF]</span> specification.
    </p>
    <h2 class="usecases">
      Use Cases
    </h2>
    <p>
      For developers, this specification attempts to address the following use
      cases:
    </p>
    <ol>
      <li>
        <p>
          Provide a URI scheme that is compatible with the features and
          security model of [HTML], so that applications that are packaged can
          make full use of <span>[HTML]</span>'s capabilities and those of
          related technologies. For example, the <code>app:</code> uri scheme
          should be usable as a <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#the-document's-address">
          document's address</a> so that it can serve as its <a href=
          "http://www.whatwg.org/specs/web-apps/current-work/#origin">origin</a>,
          and it should be compatible with APIs that rely on
          <span>[HTTP]</span> responses, like <span>[XHR]</span>.
        </p>
      </li>
      <li>
        <p>
          Provide a URI scheme that is secure, in that it is constrained to
          just resources within a package.
        </p>
      </li>
      <li>Provide an addressing scheme that is easy to work with - and that
      developers are already accustomed to working with. The developer should
      not be bother as to wether they are using <code>http://</code> or <code>
        app://</code> - the Web's capabilities and APIs need to just work!
      </li>
    </ol>
    <h2 class="no-num">
      Acknowledgements
    </h2>
    <p>
      The bulk of the text in this specifications was derived from the
      <cite><a href="http://www.w3.org/TR/widgets-uri/">Widget URI
      scheme</a></cite> specification. The Systems Application working group
      acknowledge the hard work of the <a href=
      "http://www.w3.org/2008/webapps/">Web Applications Working Group</a> in
      laying down the foundations for this specification.
    </p>
    <p>
      Thanks also to Robin Berjon, who helped edit this specification when it
      was part of WebApps.
    </p>
    <p>
      Graphic icons used some examples of this specification were created by
      <a href="http://omercetin.deviantart.com/">Ömer ÇETİN</a> and are
      available for use under a <a href=
      "http://creativecommons.org/licenses/by/3.0/">Creative Commons
      Attribution 3.0 license</a>.
    </p>
    <h2 class="no-num">
      Normative references
    </h2>
    <dl class="bibliography">
      <dt>
        <dfn>[ABNF]</dfn>
      </dt>
      <dd>
        <a href="http://www.ietf.org/rfc/rfc5234.txt"><cite>Augmented BNF for
        Syntax Specifications: <abbr title=
        "Augmented Backus-Naur Form">ABNF</abbr></cite></a>. IETF.
      </dd>
      <dt>
        <dfn>[HTML]</dfn>
      </dt>
      <dd class="w3c">
        <cite><a href="http://www.w3.org/TR/html5/">HTML5</a></cite>. W3C.
      </dd>
      <dd class="nopub">
        <cite><a href="http://www.whatwg.org/specs/web-apps/current-work/">HTML
        Standard</a></cite>. WHATWG.
      </dd>
      <dt>
        <dfn>[HTTP]</dfn>
      </dt>
      <dd>
        <a href="http://tools.ietf.org/html/rfc2616"><cite>Hypertext Transfer
        Protocol -- HTTP/1.1</cite></a>. IETF.
      </dd>
      <dt>
        <dfn>[RFC2119]</dfn>
      </dt>
      <dd>
        <a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key words for use
        in RFCs to Indicate Requirement Levels</cite></a>. IETF.
      </dd>
      <dt>
        <dfn>[IRI]</dfn>
      </dt>
      <dd>
        <a href="http://tools.ietf.org/html/rfc3987"><cite>Internationalized
        Resource Identifiers (IRIs)</cite></a>. IETF.
      </dd>
      <dt>
        <dfn>[SNIFF]</dfn>
      </dt>
      <dd>
        <a href="http://mimesniff.spec.whatwg.org/"><cite>Media Type
        Sniffing</cite></a>. WHATWG.
      </dd>
      <dt>
        <dfn title="uuid-spec">[UUID]</dfn>
      </dt>
      <dd>
        <a href="http://tools.ietf.org/html/rfc4122"><cite>A Universally Unique
        Identifier (UUID) URN Namespace</cite></a>. IETF.
      </dd>
      <dt>
        [URL]
      </dt>
      <dd>
        <a href="http://url.spec.whatwg.org/"><cite>URL.</cite></a> WHATWG.
      </dd>
    </dl>
    <h2 class="no-num">
      Informative references
    </h2>
    <dl class="bibliography">
      <dt>
        <dfn>[XHR]</dfn>
      </dt>
      <dd>
        <a href="http://www.w3.org/TR/XMLHttpRequest2/"><cite>XHR</cite></a>
        (Work in progress). W3C.
      </dd>
      <dt>
        <dfn>[RFC1738]</dfn>
      </dt>
      <dd>
        <a href="http://www.ietf.org/rfc/rfc1738.txt"><cite>Uniform Resource
        Locators (URL)</cite></a> (Obsolete). IETF.
      </dd>
      <dt>
        <dfn>[SVG]</dfn>
      </dt>
      <dd>
        <a href="http://www.w3.org/TR/SVGTiny12/">Scalable Vector Graphics
        (SVG) Tiny 1.2 Specification</a>. W3C.
      </dd>
      <dt>
        <dfn>[WebStorage]</dfn>
      </dt>
      <dd>
        <a href="http://dev.w3.org/html5/webstorage/"><cite>Web
        Storage</cite></a> (Work in Progress). W3C.
      </dd>
    </dl>
  </body>
</html>
